<!DOCTYPE html>
<html lang="en">
    <script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><link rel="icon" href="http://localhost:1313/mor.jpg" type="image/icon type">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="All rights reserved - @chxmxii_ ">
<meta name="description" content="SecuritySecurity
" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/cka/certified-kubernetes-administrator-84224f6e5ecc49bcabde5fef4bec64d2/security-9e9f3492cbd44403a15ebc6cc9fac56d/" />


    <title>
        
             :: Mouhib CHVMSI 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="http://localhost:1313/scss/main.scss">



    <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
    <link rel="manifest" href="http://localhost:1313/site.webmanifest">
    <link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="http://localhost:1313/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Mouhib CHVMSI">
  <meta itemprop="description" content="SecuritySecurity">
  <meta itemprop="wordCount" content="2405">
  <meta itemprop="image" content="http://localhost:1313/">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="Mouhib CHVMSI">
  <meta name="twitter:description" content="SecuritySecurity">



    <meta property="og:url" content="http://localhost:1313/cka/certified-kubernetes-administrator-84224f6e5ecc49bcabde5fef4bec64d2/security-9e9f3492cbd44403a15ebc6cc9fac56d/">
  <meta property="og:site_name" content="Mouhib CHVMSI">
  <meta property="og:title" content="Mouhib CHVMSI">
  <meta property="og:description" content="SecuritySecurity">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="cka">
    <meta property="og:image" content="http://localhost:1313/">















    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark"> </span>
            <span class="logo__text">C:\Users\chxmxii\</span>
            <span class="logo__text" style="color:#ff3c36">Security 9e9f3492cbd44403a15ebc6cc9fac56d</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#ff3c36;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about.txt/" style="text-decoration: none;" class="name">About</a></li><li><a href="http://localhost:1313/posts/" style="text-decoration: none;" class="name">Posts</a></li><li><a href="http://localhost:1313/projects/" style="text-decoration: none;" class="name">Projects</a></li><li><a href="http://localhost:1313/writeups/" style="text-decoration: none;" class="name">Writeups</a></li><li><a href="http://localhost:1313/error.html" style="text-decoration: none;" class="name">~Resume</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/cka/certified-kubernetes-administrator-84224f6e5ecc49bcabde5fef4bec64d2/security-9e9f3492cbd44403a15ebc6cc9fac56d/"></a></h2>

            
            
            

            <div class="post-content">
                <html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Security</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="9e9f3492-cbd4-4403-a15e-bc6cc9fac56d" class="page sans"><header><img class="page-cover-image" src="Scheduling%20801cba32ed774f60b88fd32e4a4c5e2f/k8s.png" style="object-position:center 50%"/><div class="page-header-icon page-header-icon-with-cover"><img class="icon" src="Scheduling%20801cba32ed774f60b88fd32e4a4c5e2f/logo.png"/></div><h1 class="page-title">Security</h1><p class="page-description"></p></header><div class="page-body"><ul id="8dd028c3-6135-465a-9519-645760da157e" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">Security Primitives</mark></strong></summary><ul id="9e9df424-8f77-43c0-aa18-407d9291db85" class="bulleted-list"><li style="list-style-type:disc">As we already know, the Kube-API server is at the center of all operations within Kubernetes. We interact with it through the <mark class="highlight-blue"><code>kubectl</code></mark><mark class="highlight-blue"> </mark>utility or by accessing the API directly, and with that, you can perform any operation on the cluster. </li></ul><ul id="7b69eb34-94bc-4347-b92d-7f728b47a5dd" class="bulleted-list"><li style="list-style-type:disc">Securing the API server is very important, thus two decisions should be made. Who <strong>can access</strong>? and what they <strong>can do</strong>? <strong>Authentification </strong>and <strong>Authorization</strong>.</li></ul><figure id="4ce7b944-6d2b-455d-ae24-60cb86de5a68" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled.png"><img style="width:734px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled.png"/></a></figure><p id="e308b6a6-d896-43ae-b2b7-b9f985e6c421" class=""><strong><mark class="highlight-blue">Authentication</mark></strong><div class="indented"><p id="f526925c-8534-48f7-bd28-14ec01d4b215" class="">Different ways can be used to authenticate to the API server. </p><p id="166273c4-7e07-4c41-a989-b72e6b53b7d4" class="">→ User IDS and passwords stored in a static file <code><mark class="highlight-purple">password, username, UID, Groups(opt)</mark></code><mark class="highlight-purple"> </mark></p><p id="cd7befac-6875-491c-97f3-ce9042c3d32f" class="">→ Tokens </p><p id="f9e6765e-fe66-46e4-bbf1-f3943d7d8682" class="">→ Certificates</p><p id="4451ade7-afca-4d91-b1ff-9c9f1695a164" class="">→ Integration with external authentication providers like <strong>LDAP</strong>.</p><p id="031a2250-bf47-46f8-99b8-61fdc3787bbb" class="">⇒ For machines we use <mark class="highlight-purple"><strong>Service Accounts</strong></mark><strong>.</strong><div class="indented"><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="06b62b47-7908-46c9-ba08-491a19a40c4e"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">For the basic authentication, make sure to pass the file path within the kubeapi-server.service file <mark class="highlight-purple"><code>--basic-auth-file=user-details.csv</code></mark><mark class="highlight-purple"> </mark>and restart the service.<br/>Same when using <br/><strong>tokens </strong>to authenticate <mark class="highlight-purple"><code>--token-auth-file=user-details.csv</code></mark>.<mark class="highlight-purple"><br/><br/></mark>+ consider volume mounts.</div></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="34c637ad-ba2e-4de2-a82e-70112b1403ae" class="code"><code class="language-Shell">While Authenticating use:
# Basic auth
$ curl -v -k https://10.0.1.2:6443/api/v1/pods -u &quot;&lt;user&gt;:&lt;password&gt;&quot;
# Token auth
$ curl -v -k https://10.0.1.2:6443/api/v1/pods --header &quot;Authorization: Bearer &lt;token&gt;&quot;</code></pre></div></p></div></p><p id="85569d1c-7dbf-4ec4-a752-cddc27d00997" class=""><strong><mark class="highlight-blue">Authorization</mark></strong><div class="indented"><p id="b3f76a89-eaec-4191-9e18-50d15b2c7e89" class="">Once the access is gained within the cluster, you define what operations <strong>X </strong>can perform.</p><ul id="17b3563e-ca1f-4fc2-9e03-307e0dffb65f" class="bulleted-list"><li style="list-style-type:disc">Authorization is implemented using <strong>Role-Based-Access-Control</strong>, where users are associated to groups with specific permissions.</li></ul><ul id="046cb70e-85df-405f-9cd9-752d55699b93" class="bulleted-list"><li style="list-style-type:disc">Other authorization modules like <strong>Attribute-Based-Access-Control</strong>, <strong>Node Authorizer</strong>, <strong>Webhooks</strong>, etc.</li></ul></div></p><p id="e5b5edd9-0fcd-479f-902f-6fee1cbe3275" class=""><mark class="highlight-blue"><strong>++ Adds</strong></mark></p><ul id="d8346e3a-5d57-431b-8bab-0aa98650c862" class="bulleted-list"><li style="list-style-type:disc">All communication between various components is secured using <strong>TLS encryption.</strong></li></ul><ul id="efce6ca6-20a2-4b58-b659-086c95a22053" class="bulleted-list"><li style="list-style-type:disc">All communication between applications within the cluster is restricted using <strong>Network policies.</strong></li></ul></details></li></ul><ul id="afcf3464-77e2-4d83-9c67-f6c66e1a412b" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">TLS Certificates</mark></strong></summary><figure id="fa3ef646-6c06-456a-b048-247eaf81c8aa"><div class="source"><a href="https://www.youtube.com/watch?v=SJJmoDZ3il8">https://www.youtube.com/watch?v=SJJmoDZ3il8</a></div></figure><figure id="0e4e03e6-65d4-4739-81eb-eddcbaab24d8"><div class="source"><a href="https://www.youtube.com/watch?v=LJDsdSh1CYM">https://www.youtube.com/watch?v=LJDsdSh1CYM</a></div></figure></details></li></ul><ul id="a969e8d1-0479-4773-ab18-23bd6da07f0a" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">TLS in Kubernetes</mark></strong></summary><ul id="d652ac3e-0d59-4f88-955c-47be94d24575" class="bulleted-list"><li style="list-style-type:disc">Communication between all the components within the Kubernetes should be secured using the TLS certificates. All services within the cluster should use server certificates, and all clients should use client certificates to verify who they are.</li></ul><ul id="b6daad4a-d4bb-4764-a8b9-b57ffc9b19e7" class="toggle"><li><details open=""><summary><mark class="highlight-blue"><strong>Certificates for servers</strong></mark></summary><ul id="9ad7cc8e-deaf-437a-86f3-16217e27b113" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The kube-API server</strong></mark><mark class="highlight-blue"> </mark>exposes an HTTP service to allow users/components to manage the cluster. Hence, It requires a certificate to secure all communications with its clients.<figure id="ddbfd2c3-d41b-469d-96f9-da5d56f93c91" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%201.png"><img style="width:624px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%201.png"/></a></figure></li></ul><ul id="a70372e0-ff26-4073-8990-3420f9db571a" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The ETCD server</strong></mark><strong> </strong>stores all the information about the cluster so it requires also a certificate to secure communication with its unique client which is the API server.<figure id="5626878b-841a-42d5-9ed0-bea29a2e71a8" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%202.png"><img style="width:624px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%202.png"/></a></figure></li></ul><ul id="83c95821-a34e-483b-a999-89cd80331736" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The Kubelet</strong></mark><mark class="highlight-blue"> </mark>service also exposes an HTTP service to allow interaction with the Kube API server to manage the worker nodes.<figure id="f65246ca-18b7-4340-844b-f088d6c6d774" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%203.png"><img style="width:624px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%203.png"/></a></figure></li></ul></details></li></ul><ul id="c1076f34-0b52-43f2-9dff-1a05bcec0b93" class="toggle"><li><details open=""><summary><mark class="highlight-blue"><strong>Certificates for clients</strong></mark></summary><ul id="a906ac0f-15e6-4934-b423-9506f2274657" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The admin</strong></mark> responsible for managing the cluster requires a certificate and key pair to authenticate to the Kube-API server.</li></ul><ul id="b3bde73c-dde8-4ab8-ac00-1cc950556acb" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The Kube scheduler</strong></mark><mark class="highlight-blue"> </mark>also interacts with the Kube-API server to look for pods that require scheduling, Hence, it needs to validate its identity using a client TLS certificate.</li></ul><ul id="c915d87f-3f64-453a-9e6c-94047d7df91f" class="bulleted-list"><li style="list-style-type:disc"><strong><mark class="highlight-blue">The Kube Controller Manager </mark></strong>also communicates with the Kube-API server so a certificate and key pair are needed to authenticate to the API server.</li></ul><ul id="ac7588bb-bc72-4301-96af-7bd86f09e6a6" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The Kube proxy</strong></mark><mark class="highlight-blue"> </mark>also needs to authenticate to the Kube-API server, thus it needs to generate a certificate and key pairs to verify its identity.</li></ul><ul id="30179ca2-9c43-4a94-9b82-a02200c7f55a" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><strong>The Kube API server </strong></mark>communicates to the <strong>etcd </strong>server and to the <strong>Kubelet </strong>server as a client, you can either use the same keys generated for serving its own API service Or you can generate a new pair of certificates specifically for the Kube API server to validate its identity.</li></ul><figure id="b7cd1f05-c8bf-4c7b-b884-a49ca4c171a8" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%204.png"><img style="width:672px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%204.png"/></a></figure></details></li></ul><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="0a219fbc-3ab9-4860-8baa-e95fbeb6f575"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><strong>Public keys </strong>are usually named “.crt | .pem” extensions. → server.crt/server.pem for server - client.crt/client.pem for clients.<p id="daa2b8fc-9f9a-4874-bea7-8c3f9d04a540" class=""><strong>Private keys </strong>are usually named “.key | *-key.pem” extensions. → server.key/server-key.pem for server - client.key/client-key.pem for clients.</p></div></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f8820e86-a583-4e0a-b3a0-e301b3979f7b" class="code"><code class="language-Shell"># Sign a new certificate for the apiserver-etcd-client
openssl x509 -req -in /etc/kubernetes/pki/apiserver-etcd-client.csr -CA /etc/kubernetes/pki/etcd/ca.crt -CAkey /etc/kubernetes/pki/etcd/ca.key -CAcreateserial -out /etc/kubernetes/pki/apiserver-etcd-client.crt</code></pre><p id="27908e1e-3622-4965-91f8-711fe324408c" class="">
</p></details></li></ul><ul id="d3031931-1454-4eac-a17e-4731a298cae6" class="toggle"><li><details open=""><summary><mark class="highlight-blue"><strong>TLS Certificate Creation and Details</strong></mark></summary><p id="c6356511-af84-4e17-aea8-82d853f0553c" class="">Starting with the <strong>CA certificates</strong>;</p><ol type="1" id="07a401be-569d-4c0e-9fd7-bdf6bf2c040d" class="numbered-list" start="1"><li><mark class="highlight-blue"><code>openssl genrsa -out ca.key 2048</code></mark> → to create a private key</li></ol><ol type="1" id="aa1ff5f1-3cc3-4069-80a2-d201e9319f6c" class="numbered-list" start="2"><li><mark class="highlight-blue"><code>openssl req -new -key ca.key -subj &quot;/CN=KUBERNETES-CA&quot; -out ca.csr</code></mark> → using the private key to generate a cert signing request “.csr” which is like a certificate with all of your details but with no signature. <strong>CN</strong> stands for “common name”.</li></ol><ol type="1" id="1bb704ca-8fe3-4658-9c0a-067ea1426a39" class="numbered-list" start="3"><li><mark class="highlight-blue"><code>openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt</code></mark> → to sign the certificate.<figure id="3b35a45a-ccd9-4949-848e-c211ded2cb2f" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%205.png"><img style="width:672px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%205.png"/></a></figure></li></ol><p id="0afaee43-b945-4586-b821-f0f7c3cb6e12" class="">For <strong>admin user;</strong></p><ol type="1" id="acfc9c08-cfd7-4f32-90f9-215b5024c05a" class="numbered-list" start="1"><li><mark class="highlight-blue"><code>openssl genrsa -out admin.key 2048</code></mark><mark class="highlight-blue"> </mark>→ generate a private key</li></ol><ol type="1" id="fec445ca-f8f5-4d8c-822f-402752d68a45" class="numbered-list" start="2"><li><mark class="highlight-blue"><code>openssl req -new -key admin.key -subj &quot;CN=kube-admin&quot; -out admin.csr</code></mark><mark class="highlight-blue"> </mark>→ create a certificate sign request.</li></ol><ol type="1" id="9faadf64-9376-41fa-861a-64e33339e753" class="numbered-list" start="3"><li><mark class="highlight-blue"><code>openssl x509 -req -in admin.csr -CA ca.crt -CAkey ca.key -out admin.crt</code></mark><mark class="highlight-blue"> </mark>→ creating the certificate but this time we use the ca.crt + ca.key.</li></ol><p id="135c6ef3-0a7d-4e63-991f-34c0aaa88ebc" class=""><strong>Specifying keys;</strong></p><figure id="1e4a364f-ffa4-480d-bcff-47fa3fc6ffd4" class="image" style="text-align:center"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%206.png"><img style="width:624px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%206.png"/></a></figure><p id="27233e87-a718-4562-9858-256b668dc7f1" class=""><strong>Details;</strong></p><figure id="be01a617-048a-4759-8aeb-3b380b396586"><div class="source"><a href="https://kubernetes.io/docs/setup/best-practices/certificates/">https://kubernetes.io/docs/setup/best-practices/certificates/</a></div></figure><ul id="72615165-6429-4def-ad6b-4e8b1eedb975" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>cat /etc/kubernetes/manifests/kube-api.yml</code></mark> | <mark class="highlight-blue"><code>ps -ef | grep &quot;kube-api&quot;</code></mark>→ Within the manifest file or within the kube-api.service, you can find a list of TLS certificates used.</li></ul><ul id="d1c88567-b704-45f9-8f54-7d3dbdeb6ef0" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>openssl -x509 -in /etc/kubernetes/pki/apiserver.crt -text -noout</code></mark><mark class="highlight-blue"> </mark>→ view details of apiserver.crt for example.<figure id="e5554c2c-564d-44ec-b959-871bf90ca388" class="image" style="text-align:center"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%207.png"><img style="width:593px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%207.png"/></a></figure></li></ul></details></li></ul><ul id="3a7b5a81-b18e-4a9e-97d4-eac41c10d86e" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">Certificates API</mark></strong></summary><ul id="2f4e162d-5631-4c17-811d-305e3674498b" class="bulleted-list"><li style="list-style-type:disc">Kubernetes has a built-in Certificates API that allows you to send a Certificate Signing Request directly to Kubernetes and rotate certificates when they expire. Instead of logging onto the master node and signing the certificate, you create a Kubernetes API object called <mark class="highlight-blue"><code>CertificateSigningReque itst</code></mark><mark class="highlight-blue">.</mark> Once done, all certificates signing requests can be seen, reviewed; and approved.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ea0dd455-3ddf-419a-a41e-a71875b6e453" class="code"><code class="language-YAML">apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
	name: chxmxii
spec:
	groups:
	- system:authenticated
	usages:
	- digital signature
	- key encipherment
	- server auth
	request: &lt;base64 encoded csr&gt;</code></pre><ul id="eeae6d8b-2ef7-4816-bf85-5cea0bdb130c" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>kubectl get csr </code></mark>→ to get a list of csrs</li></ul><ul id="0995e64e-0286-4580-81c4-fc16cba40845" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>kubectl certificate approve chxmxii</code></mark><mark class="highlight-blue"> </mark>→ to approve a certificate</li></ul><ul id="2cca497c-21fc-427c-bb45-ee0bb7148989" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>kubectl certificate approve chxmxii -o yaml</code></mark><mark class="highlight-blue"> </mark>→ to view the certificate and to share it with the end user (must be b64 decoded).</li></ul><ul id="022411cb-944e-412e-a689-8ebbbf7584dd" class="bulleted-list"><li style="list-style-type:disc">It is important to note that all certificate-related operations are carried out by the <strong>controller manager </strong>specifically by <strong>CSR-APPROVING </strong>and <strong>CSR-SIGNING</strong>.<figure id="033a55ff-0e3e-4e9d-b7b5-cc50ac5c028a" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%208.png"><img style="width:606px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%208.png"/></a></figure></li></ul></details></li></ul><ul id="3618d4a8-8ed1-4526-a81d-ff249fe74483" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">KubeConfig</mark></strong></summary><ul id="e560d8ce-dd60-4bed-99da-ff4a2adefe2c" class="bulleted-list"><li style="list-style-type:disc">By default, the kubectl tool looks for a file named ~/.kube/config, this file can be used to store some information such as the client-key, client-cert, ca, or the Kubernetes server you are interacting with!</li></ul><ul id="4d4e85fd-0af7-4a0f-b934-8037294d85a5" class="bulleted-list"><li style="list-style-type:disc">the KubeConfig file has 3 sections;<ol type="1" id="09c6c0ad-baf0-4db4-b903-2444335d3a56" class="numbered-list" start="1"><li><strong>Clusters;</strong><ul id="1f4dcf03-2211-4f95-a9fe-e748be12c0d5" class="bulleted-list"><li style="list-style-type:disc">Say you manage more than one cluster, you can save all the Kubernetes clusters that you need access to here.</li></ul></li></ol><ol type="1" id="5e16141f-a497-433b-88cc-0895b57d42c3" class="numbered-list" start="2"><li><strong>Users;</strong><ul id="c3740fe7-1468-407c-866c-dd29485cd8e7" class="bulleted-list"><li style="list-style-type:disc">User accounts with which you have access to these clusters</li></ul></li></ol><ol type="1" id="e5b44000-b4e6-414a-bd9a-4213e119821b" class="numbered-list" start="3"><li><strong>Contexts;</strong><ul id="7772a9dd-cadd-4f18-af95-613a1bc9e81b" class="bulleted-list"><li style="list-style-type:disc">Marry  to  which user account will be used to access which cluster? <strong>&lt;user&gt;</strong><mark class="highlight-blue"><strong>@</strong></mark><strong>&lt;cluster&gt;</strong><figure id="b547f087-3ce1-47e6-85bd-30d83c4a004e" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%209.png"><img style="width:581px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%209.png"/></a></figure></li></ul></li></ol><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="24e076a6-4277-482c-b00e-a413b07ce9bf" class="code"><code class="language-YAML">apiVersion: v1myku
kind: Config
clusters:
	- name: mykubeplayground
		cluster:
			name: development
			certificate-authority: /path/to/ca.crt
			server: https://mykubepg:6443
users:
	- name: mykubeAdm
		user:
			client-certificate: path/to/admin.crt
			client-key: path/to/admin.key
contexts:
	- name: mykubeAdm@mykubeplayground
		context:
			cluster: mykubeplayground
			user: mykubeAdm
			namespace: dev</code></pre></li></ul><ul id="f21331db-d63f-4b92-a43e-a0914ed70bfe" class="bulleted-list"><li style="list-style-type:disc"><code><mark class="highlight-blue">kubectl config use-context mykubeAdm@mykubeplayground</mark></code><mark class="highlight-blue"> </mark>→ to change context</li></ul></details></li></ul><ul id="76ff1c1f-389f-40aa-94ff-aa8b327cdd38" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">API Groups in Kubernetes</mark></strong></summary><ul id="77e880af-024a-43ab-81cc-de082142f873" class="bulleted-list"><li style="list-style-type:disc">The Kubernetes API is grouped into multiple groups based on their purpose, such as;<ul id="19c41aaa-36b4-41c6-8a52-f1d20c0c97e1" class="bulleted-list"><li style="list-style-type:circle"><strong>/version </strong>→ for viewing the version of the cluster.</li></ul><ul id="d5adb10a-acbe-4192-bb0b-087be3ba5294" class="bulleted-list"><li style="list-style-type:circle"><strong>/metrics </strong></li></ul><ul id="62879183-9168-4c1e-bd33-543d0c532640" class="bulleted-list"><li style="list-style-type:circle"><strong>/healthz</strong> → for monitoring the health of the cluster.</li></ul><ul id="9addc93c-3b80-494d-8442-26ac65413aa5" class="bulleted-list"><li style="list-style-type:circle"><strong>/logs</strong> → integrating with third-party logging apps</li></ul></li></ul><ul id="9da5806a-1194-480f-8c81-af89e59d486c" class="bulleted-list"><li style="list-style-type:disc"><strong>Core Group</strong><figure id="ec542aa7-f62a-4fe5-bc9a-876ad345320e" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2010.png"><img style="width:384px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2010.png"/></a></figure></li></ul><ul id="4f817f35-312d-492b-8100-afb3f058b253" class="bulleted-list"><li style="list-style-type:disc"><strong>Named Group</strong><figure id="e0936abb-7565-41d8-b609-34e0ea4b10a6" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2011.png"><img style="width:660px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2011.png"/></a></figure></li></ul><p id="529a5ccd-f8f8-476b-a12c-933944ee4459" class="">To view the API group for each object you can access your Kube API server at port <strong><mark class="highlight-blue">6443.</mark></strong></p><p id="c611ff78-b958-428b-b2fb-ab7f4a18fdd1" class=""><mark class="highlight-blue"><code>$ curl http://localhost:6443 -k --key admin.key --cert admin.crt --cacert ca.crt</code></mark></p><ul id="1a22c6e5-70f0-47e5-8538-1c6001c01a88" class="bulleted-list"><li style="list-style-type:disc">An alternate option is to start the kubectl proxy client at port <strong>8001</strong>.</li></ul></details></li></ul><ul id="198f3020-6d8d-4c43-b830-2b3bceae939a" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">Role-Based Access Controls</mark></strong></summary><ul id="b6c6553f-c743-44ea-9baf-585b587356a7" class="bulleted-list"><li style="list-style-type:disc">You can create a role by creating a role object. <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="50f69ad2-6edd-4610-87d4-e3f3bce0495e" class="code"><code class="language-YAML">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
    namespace: default
    name: developer
rules:
  - apiGroups: [&quot;&quot;] # &quot;&quot; indicates the core API group 
    resources: [&quot;pods&quot;]
    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;create&quot;, &quot;delete&quot;, &quot;update&quot;]
		resourceNames: [&quot;pod1&quot;,&quot;pod2&quot;]</code></pre></li></ul><ul id="300d57df-ee31-436d-95ba-67007f036abd" class="bulleted-list"><li style="list-style-type:disc">For the <strong>core group</strong>, you can leave the <strong>apiGroups </strong>section blank, and for any other group, you specify the group name.</li></ul><ul id="e3c19f67-8e9d-4247-8052-b170618eff42" class="bulleted-list"><li style="list-style-type:disc">After creating the<strong> role</strong>, we need to link the user to it, for this, we need to create another object called <strong><mark class="highlight-blue">RoleBinding</mark></strong>, this object links a user to a role.<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="75ca5d95-9f91-4d46-9b5c-755d85f23854" class="code"><code class="language-YAML">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
	namespace: default
	name: devuser-developer-binding
subjects:
- kind: user
	name: dev-user
	apiGroup: rbac.authorization.k8s.io
roleRef:
	kind: Role
	name: developer
	apiGroup: rbac.authorization.k8s.io</code></pre></li></ul><ul id="c72dd1f1-63d2-47ba-abb6-473f183baa98" class="bulleted-list"><li style="list-style-type:disc">The <strong>RoleBinding </strong>object has two sections, the <strong>subjects </strong>are where we specify the user details, and The <strong>roleRe</strong>f section is where we provide the details of the role we created. </li></ul><ul id="e23f25b0-f570-426d-b8f4-e7e997cc31f7" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>kubectl auth can-i create deployments</code></mark><mark class="highlight-blue"> </mark>→ to check if you have permission to create a deploy.</li></ul><ul id="762970a7-810b-43c4-a218-e7fb630ed713" class="bulleted-list"><li style="list-style-type:disc"><code><mark class="highlight-blue">kubectl auth can-i create pods --as dev-user --name-space prod</mark></code><mark class="highlight-blue"> </mark>→ using th as user option to check access for the dev-user in the prod ns.</li></ul></details></li></ul><ul id="814cbcf9-8b02-4e91-b45a-95a00e9d7435" class="toggle"><li><details open=""><summary><mark class="highlight-blue"><strong>Service Accounts</strong></mark></summary><ul id="809963eb-e7ce-4831-8056-797ea9cf8ab2" class="bulleted-list"><li style="list-style-type:disc">Kubernetes has 2 types of accounts:<ul id="13b03b2b-7c8f-4387-bd06-f57aac1e7594" class="bulleted-list"><li style="list-style-type:circle">User Accounts <strong>(cluster-wide)</strong>; used by humans</li></ul><ul id="ab15b362-88cd-449e-88ed-f58712ce32dc" class="bulleted-list"><li style="list-style-type:circle">Service Accounts <strong>(namespace bound)</strong>; used by external applications to interact with the k8s cluster<ul id="1f4f6738-0575-4582-bf94-498fbfe29081" class="bulleted-list"><li style="list-style-type:square">Prometheus uses a SA to poll the k8s APPII for performance metrics</li></ul><ul id="257781ec-2baf-4b92-a02c-b27b30320cb9" class="bulleted-list"><li style="list-style-type:square">ArgoCD uses service accounts to deploy apps on a k8s cluster</li></ul><figure id="7093f652-a955-48b5-bf4b-6f37f58f931c" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2012.png"><img style="width:494px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2012.png"/></a></figure></li></ul></li></ul><ul id="fd99c037-0eb9-4a89-992d-a06d2b634c12" class="bulleted-list"><li style="list-style-type:disc"><strong>Default Service Account;</strong><ul id="eb0d14c7-1426-4df2-9a80-e2e5c84ffc9f" class="bulleted-list"><li style="list-style-type:circle">For every namespace, a default service account is created automatically, when a pod is created the default service account is associated automatically with the pod, and its token ‘secret object’ is mounted to the pod as a volume mount at location <mark class="highlight-blue"><code>/var/run/secrets/kubernetes.io/serviceaccount</code></mark><mark class="highlight-blue">.</mark><figure id="7bcb73e2-f050-40d8-8420-01d03f89f3c2" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2013.png"><img style="width:1280px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2013.png"/></a></figure></li></ul></li></ul><ul id="cf580bee-eec7-431a-83f5-36ea50a50f40" class="bulleted-list"><li style="list-style-type:disc">Using custom <strong>Service Accounts;</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dcdd62c3-7d25-4111-ae18-f3a27857cbc6" class="code"><code class="language-YAML">apiVersion: v1
kind: Pod
metadata:
	name: webapp
spec:
	container:
	- name: nginx
		image: nginx
	serviceAccountName: monitor-sa
# autmountServiceAccountToken: false 
# this will prevent the default service account token from being autoo-mounted to the pod.</code></pre><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="cc0d0352-96d6-4336-86bd-26fda4e5b332"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">The SA of a pod cannot be updated, the pod must be deleted and re-created with a different SA. However, the SA in a deployment can be updated as the deployment takes care of deleting and recreating the pods.</div></figure></li></ul><ul id="0b1478ab-4f1a-4123-a17c-e06934661dbe" class="bulleted-list"><li style="list-style-type:disc">From v1.24 onwards, The <mark class="highlight-blue"><code>TokenRequestAPI</code></mark><mark class="highlight-blue"> </mark>is used to provision tokens for service accounts, these tokens are audience-bound, time-bound, and object-bound. Hence, they are more secure. </li></ul><ul id="a5585558-0f17-4ff3-9853-e7cc75115566" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-blue"><code>kubectl create token &lt;sa_name&gt;</code></mark><mark class="highlight-blue"> </mark>→ this will create a token with a default validity of 1h and can be modified by passing some args when creating the token. the token is then mounted to the pod as aa projected volume.<figure id="2e671398-1d8e-4c27-9a9f-e4893888e562" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2014.png"><img style="width:1280px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2014.png"/></a></figure></li></ul><ul id="b3c0f928-653a-4cfa-a156-c50bb8a54660" class="bulleted-list"><li style="list-style-type:disc">You can limit the SA access using RBAC.<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a2668946-a332-4b2a-9962-c8e89599b520" class="code"><code class="language-YAML">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
	name: pod-reader
rules:
- apiGroups: [&#x27;&#x27;]
	resources: [&#x27;pods&#x27;]
	verbs: [&#x27;get&#x27;, &#x27;watch&#x27;, &#x27;list&#x27;]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
	name: read-pods
subjects:
- kind: ServiceAccount
	name: dashboard-sa
	#NO apiGroup should be specified when subject kind is service account
roleRef:
	kind: Role
	name: pod-reader
	apiGroup: rbac.authorization.k8s.io</code></pre></li></ul></details></li></ul><ul id="53798d7f-2b2f-4ad4-8c6b-29381803a3c9" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">Cluster Roles and Role Bindings</mark></strong></summary><ul id="7b4009a6-dc19-4390-99ca-0778b2c69d05" class="bulleted-list"><li style="list-style-type:disc"><strong>Cluster Roles </strong>are just like <strong>Roles</strong> except they are for a cluster scoped resources e.g nodes, pv, and pvc.<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ef4c1f02-ab20-409d-8dad-358adca576a3" class="code"><code class="language-YAML">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata: 
	namespace: default
	name: cluster-administrator
rules:
	- apiGroups: [&quot;&quot;] #&quot;&quot; indicates the core API group
		resources: [&quot;nodes&quot;]
		verbs: [&quot;get&quot;, &quot;list&quot;, &quot;create&quot;, &quot;delete&quot;]</code></pre></li></ul><ul id="81f05a87-f293-475c-adf3-42c3a273ca8d" class="bulleted-list"><li style="list-style-type:disc">After creating the ClusterRole, you will need to link the user to it, for this we create an object called ClusterRoleBinding.<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c8cd0d39-7b94-43fd-a90c-a14a1bf46e09" class="code"><code class="language-YAML">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata: 
	namespace: default
	name: cluster-administrator
subjects:
- kind: user
	name: cluster-admin
	apiGroup: rbac.authorization.k8s.io
roleRef:
	kind: ClusterRole
	name: cluster-administrator
	apiGroup: rbac.authorization.k8s.io</code></pre><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="0cef863f-77ce-4c7f-8c5b-055468da7414"><div style="font-size:1.5em"><span class="icon">⚠️</span></div><div style="width:100%">Note that you can create a ClusterRole for a namespace resource, but when you authorize a user to access Pods the user gets access to all Pods across the cluster.</div></figure></li></ul><figure id="13c35b45-095f-4475-a933-543cfca85354" class="image"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2015.png"><img style="width:720px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2015.png"/></a></figure></details></li></ul><ul id="bf55f097-afab-41c0-9ac5-b9c2d76d5109" class="toggle"><li><details open=""><summary><strong><mark class="highlight-blue">Image Security</mark></strong></summary><ul id="b8bf8e46-1865-4918-9219-68cccfcdc10d" class="bulleted-list"><li style="list-style-type:disc">Using a <strong>private registry; </strong>you need to make a secret with the type <mark class="highlight-blue"><code>docker-registry</code></mark>, and put your docker server, username, password, and email. <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2efa7f64-801a-4f02-9d04-72d452fce47b" class="code"><code class="language-Shell">kubectl create secret docker-registry regcred \
--docker-server=private-registry.io \
--docker-username=chxmxii \
--docker-password=chxmxii01230 \
--docker-email=contact@chx.global.temp.domains</code></pre></li></ul><ul id="091e43f1-c5e5-4309-a47e-855fac6cd1af" class="bulleted-list"><li style="list-style-type:disc">You can call the secret using <mark class="highlight-blue"><code>imagePullSecrets</code></mark><mark class="highlight-blue"> </mark>when pulling an image from a <strong>private registry;</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e0ba567a-3a31-4b87-a983-c2a8fc797db0" class="code"><code class="language-YAML">apiVersion: v1
kind: Pod
metadata:
	name: myapp
spec:
	containers:
	- name: myApp-container
		image: private-registry.io/apps/my-app
	imagePullSecrets:
	- name: regcred</code></pre></li></ul></details></li></ul><ul id="10f4d775-e3f8-4b09-990e-921513ff3c2f" class="toggle"><li><details open=""><summary><mark class="highlight-blue"><strong>Security Contexts</strong></mark></summary><ul id="47b5b2cf-4914-4c15-adf2-3269113f8777" class="bulleted-list"><li style="list-style-type:disc">A security context defines privilege and access control settings for a Pod or container, and you may choose to configure the security settings at a container level or a POD level.</li></ul><ul id="45f4dc21-6040-4e0e-95b2-f20df599b616" class="bulleted-list"><li style="list-style-type:disc">If you configure it at a POD level the settings will be applied to all the containers within the POD.</li></ul><ul id="09e67d1d-87d4-441c-96d7-c9f5981c2638" class="bulleted-list"><li style="list-style-type:disc">If you configure it at both the Pod and the container, the settings on the container will override the settings on the POD. </li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31cb27a7-f67c-42a3-b5c6-38f34d6ee05b" class="code"><code class="language-YAML">apiVersion: v1
kind: Pod
metadata:
	name: my-web-app
spec:
# at the pod leve:
#	securityContext: 
#		runAsUser: 1005
	containers:
	- name: nginx
		image: nginx
		command: [&quot;sleep&quot;, &quot;1000&quot;]
		securityContext: #at the container level
			runAsUser: 1005 
			capabilities: #caps are only supported a the container level
				add: [&quot;SYS_ADMIN&quot;] 
</code></pre></details></li></ul><ul id="a6158ce6-182a-491e-b708-239af26a1fe0" class="toggle"><li><details open=""><summary><mark class="highlight-blue"><strong>Network Policies</strong></mark></summary><ul id="23b0b941-41cc-4545-816b-37bfb823a4c3" class="bulleted-list"><li style="list-style-type:disc">By default, all pods within the cluster can communicate with each other. which means no rules are stopping the pods from reaching each other.</li></ul><ul id="94f49c0c-3cba-4578-935f-78ae31a0e049" class="bulleted-list"><li style="list-style-type:disc"><strong>Network policies </strong>help control the flow of ingress and egress to a group of pods using labels and selectors.</li></ul><ul id="5a79dd24-7849-42b1-9843-f745d3c5a50f" class="bulleted-list"><li style="list-style-type:disc"><strong>Network policies </strong>are stateful, meaning if the request is allowed, the response will be allowed automatically too. Note that the resulting network policy for a pod is the union of all the associated network policies and the order of eval(rule) does not matter.  </li></ul><p id="e054fea1-b5a2-4f83-be11-4518149b714f" class="">Network Policy for the <strong>database pod;</strong></p><figure id="dc047312-6554-4007-b69a-a611bdafaa1e" class="image" style="text-align:center"><a href="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2016.png"><img style="width:480px" src="Security%209e9f3492cbd44403a15ebc6cc9fac56d/Untitled%2016.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6815955d-e2cf-4b7d-85ea-c655d23a460d" class="code"><code class="language-YAML">apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
	name: db-policy
spec:
	podSelector:
		matchLabels:
			role: db
		policyTypes:
		  - Ingress #allowing ingress traffic
			- Egress #allowing egress traffic
		ingress:
			- from:
				- podSelector:
						matchLabels:
							role: api
					#to restrict access to the DB pod within the current ns only.
					namespaceSelector:
						matchLabels:
							name: prod
				# allow ingress traffic from a specific ip addr 
				- ipBlock:
						cidr: 192.168.5.10/32
				ports:
					- protocol: TCP
						port: 3306
		egress:
			- to:
				- ipBlock:
						cidr: 192.168.5.10/32
				ports:
					- protocol: TCP
						port: 3306</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="012e7a10-dccc-470e-86e8-ee459b6855d1" class="code"><code class="language-YAML">#LAB
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: internal-policy
spec:
  podSelector:
    matchLabels:
      name: internal  
  policyTypes:
    - Ingress
    - Egress
  egress:
    - to:
      - podSelector:
          matchLabels:
            name: payroll
      - podSelector:
          matchLabels:
            name: mysql
      #        - podSelector:
      #     matchExpressions:
      #       - key: name
      #         operator: In
      #         values: [&quot;payroll&quot;, &quot;mysql&quot;]
      ports:
        - protocol: TCP
          port: 8080
        - protocol: TCP
          port: 3306
  ingress:
    - {}
#ref: https://stackoverflow.com/questions/62248909/how-does-matchexpressions-work-in-networkpolicy</code></pre></details></li></ul><hr id="dc80c9c7-d615-44f0-89c0-c49ec0840b2d"/><h2 id="f30c47eb-f3f5-46ea-b7ec-11680bb59cd7" class=""><strong>LAB; </strong></h2><p id="c5ae726c-ae55-4e6e-b6d8-e7e0b509442c" class=""><strong><strong>RBAC User Permissions;</strong></strong></p><p id="52a49ea1-67e2-4337-9e84-af172d6fc529" class="">There is existing <em>Namespace</em> <code>applications</code> .</p><ol type="1" id="915bb617-e8b3-4be5-9dc8-c517151f4238" class="numbered-list" start="1"><li>User <code>smoke</code> should be allowed to <code>create</code> and <code>delete</code> <em>Pods</em>, <em>Deployments</em> and <em>StatefulSets</em> in <em>Namespace</em> applications.</li></ol><ol type="1" id="ba2be120-116a-4c04-9418-d3b66256aad5" class="numbered-list" start="2"><li>User <code>smoke</code> should have <code>view</code> permissions (like the permissions of the default <em>ClusterRole</em> named <code>view</code> ) in all <em>Namespaces</em> but not in <code>kube-system</code> .</li></ol><ol type="1" id="ed2c7cff-eee8-40dc-89ab-53a54a85ece1" class="numbered-list" start="3"><li>Verify everything using <code>kubectl auth can-i</code> .</li></ol><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b6adce5a-d9d6-45fe-9bfc-8952b253668e" class="code"><code class="language-YAML">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: applications
  name: smoke-rbac
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;]
  verbs: [&quot;create&quot;, &quot;delete&quot;]
- apiGroups: [&quot;apps&quot;]
  resources: [&quot;statefulsets&quot;, &quot;deployments&quot;]
  verbs: [&quot;create&quot;, &quot;delete&quot;]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  namespace: applications
  name: smoke-rb
subjects:
- kind: User
  name: smoke
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: smoke-rbac
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: smoke-crbac
  namespace: {{nss}}
subjects:
- kind: User
  name: smoke
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="113adc7b-e157-442e-92b7-a1cd7b184474" class="code"><code class="language-Shell">for i in $(k get ns --no-headers | cut -d&#x27; &#x27; -f1 | grep -v -E &quot;kube-system|local-path-storage&quot;); do sed &quot;s/{{nss}}/$i/g&quot; solution.yml | kubectl apply -f - ; done</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1fa13d9d-1458-445c-b9fa-8d096d6125f0" class="code"><code class="language-Shell">using declartive way;
k -n applications create role smoke --verb create,delete --resource pods,deployments,sts
k -n applications create rolebinding smoke --role smoke --user smoke
---
k get ns # get all namespaces
k -n applications create rolebinding smoke-view --clusterrole view --user smoke
k -n default create rolebinding smoke-view --clusterrole view --user smoke
k -n kube-node-lease create rolebinding smoke-view --clusterrole view --user smoke
k -n kube-public create rolebinding smoke-view --clusterrole view --user smoke</code></pre><hr id="cde859d0-4f0a-45a7-96a2-53204f6be115"/><h3 id="cd7fbce6-d379-44b7-bafa-122d55d7c283" class="">NOTES;</h3><p id="6a5218ff-8967-4b18-b651-f0426097d413" class="">A <em>ClusterRole</em>|<em>Role</em> defines a set of permissions and where it is available, in the whole cluster or just a single <em>Namespace</em>.</p><p id="05545044-72a3-41a4-83fa-039fe21ee088" class="">A <em>ClusterRoleBinding</em>|<em>RoleBinding</em> connects a set of permissions with an account and defines where it is applied, in the whole cluster or just a single <em>Namespace</em>.</p><p id="6d80048f-fe80-4a37-a60c-51e0914a01a5" class="">Because of this there are 4 different RBAC combinations and 3 valid ones:</p><ol type="1" id="a5dd3fc3-df2d-4283-ba1c-fd0ea522532a" class="numbered-list" start="1"><li><em>Role</em> + <em>RoleBinding</em> (available in single <em>Namespace</em>, applied in single <em>Namespace</em>)</li></ol><ol type="1" id="e2fc3c15-8979-4f88-91a1-0bd4f242d2e4" class="numbered-list" start="2"><li><em>ClusterRole</em> + <em>ClusterRoleBinding</em> (available cluster-wide, applied cluster-wide)</li></ol><ol type="1" id="838ff841-9bdb-4df1-9ec6-ff4b7d7505ec" class="numbered-list" start="3"><li><em>ClusterRole</em> + <em>RoleBinding</em> (available cluster-wide, applied in single <em>Namespace</em>)</li></ol><ol type="1" id="26ed9e80-69a1-49f4-9556-5c1ec5a34e62" class="numbered-list" start="4"><li><em>Role</em> + <em>ClusterRoleBinding</em> (<strong>NOT POSSIBLE</strong>: available in single <em>Namespace</em>, applied cluster-wide)</li></ol><hr id="103fdcfe-075f-405a-8bea-27e4e051411b"/><p id="2e3a2f67-d7a8-467a-a66a-cbbc8d2f9fcf" class=""><strong>NetworkPolicy;</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="82504553-e26b-4022-b895-b3d69f1187ab" class="code"><code class="language-YAML">piVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: np
  namespace: space1
spec:
  podSelector: {}
  policyTypes:
  - Egress
  egress:
  - to:
     - namespaceSelector:
        matchLabels:
         kubernetes.io/metadata.name: space2
  - ports:
    - port: 53
      protocol: TCP
    - port: 53
      protocol: UDP
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: np
  namespace: space2
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  ingress:
   - from:
     - namespaceSelector:
        matchLabels:
         kubernetes.io/metadata.name: space1</code></pre></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    
<div id="particles-js" style="position: fixed; inset: 0; z-index: -1;"></div>
<script src="http://localhost:1313/js/particles.min.js"></script>
<script>
  particlesJS('particles-js',
    {
      "particles": {
        "number": {
          "value": 25,
          "density": {
            "enable": true,
            "value_area": 800
          }
        },
        "color": {
          "value": "#424569"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#ff3f38"
          },
          "polygon": {
            "nb_sides": 5
          },
          "image": {
            "src": "img/github.svg",
            "width": 100,
            "height": 100
          }
        },
        "opacity": {
          "value": 0.2305594644660164,
          "random": false,
          "anim": {
            "enable": false,
            "speed": 1,
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 3,
          "random": true,
          "anim": {
            "enable": false,
            "speed": 40,
            "size_min": 0.1,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": "#ff3f38",
          "opacity": 0.19875815902242794,
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 6,
          "direction": "none",
          "random": false,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": false,
            "mode": "repulse"
          },
          "onclick": {
            "enable": false,
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 400,
            "line_linked": {
              "opacity": 1
            }
          },
          "bubble": {
            "distance": 400,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 4
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    }
  );
</script>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            
            
            
            <span>© All right reserved chxmxii - 2022</span>
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="http://localhost:1313/bundle.min.63e1cd4087b02bc78961fcab2aaf77e957e2227557c73ab774f1cc4a9db0645e90d2403ca03e55eb0887e432e82aea10afe7f125052af6dd46cfea148ecbc663.js" integrity="sha512-Y&#43;HNQIewK8eJYfyrKq936VfiInVXxzq3dPHMSp2wZF6Q0kA8oD5V6wiH5DLoKuoQr&#43;fxJQUq9t1Gz&#43;oUjsvGYw=="></script>




    </body>
</html>
