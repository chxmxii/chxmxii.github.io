<!DOCTYPE html>
<html lang="en">
    <script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><link rel="icon" href="http://localhost:1313/mor.jpg" type="image/icon type">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="chxmxii_">
<meta name="description" content="
CHALLENGE 1; Challenge Description: DNSing with the Stars You&rsquo;ve gained shell access to a compromised Kubernetes pod and your next objective is to further compromise internal services. As a warm-up, utilize DNS scanning to uncover hidden internal services and obtain the flag. We&rsquo;ve provided dnscan to facilitate this process for upcoming challenges.
All flags in this challenge follow the format: wiz_k8s_lan_party{*}
Solution; Given the task at hand, my initial approach was to inspect the environment variables, a tactic that proved fruitful.
" />
<meta name="keywords" content=", Kubernetes, CTF" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/writeup11.txt/" />


    <title>
        
            K8SLANPARTY - CHALLENGES :: Mouhib CHVMSI 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="http://localhost:1313/scss/main.scss">



    <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
    <link rel="manifest" href="http://localhost:1313/site.webmanifest">
    <link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="http://localhost:1313/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="K8SLANPARTY - CHALLENGES">
  <meta itemprop="description" content="
CHALLENGE 1; Challenge Description: DNSing with the Stars You’ve gained shell access to a compromised Kubernetes pod and your next objective is to further compromise internal services. As a warm-up, utilize DNS scanning to uncover hidden internal services and obtain the flag. We’ve provided dnscan to facilitate this process for upcoming challenges.
All flags in this challenge follow the format: wiz_k8s_lan_party{*}
Solution; Given the task at hand, my initial approach was to inspect the environment variables, a tactic that proved fruitful.">
  <meta itemprop="datePublished" content="2023-08-21T00:00:00+00:00">
  <meta itemprop="dateModified" content="2023-08-21T00:00:00+00:00">
  <meta itemprop="wordCount" content="432">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Kubernetes,CTF">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="K8SLANPARTY - CHALLENGES">
  <meta name="twitter:description" content="
CHALLENGE 1; Challenge Description: DNSing with the Stars You’ve gained shell access to a compromised Kubernetes pod and your next objective is to further compromise internal services. As a warm-up, utilize DNS scanning to uncover hidden internal services and obtain the flag. We’ve provided dnscan to facilitate this process for upcoming challenges.
All flags in this challenge follow the format: wiz_k8s_lan_party{*}
Solution; Given the task at hand, my initial approach was to inspect the environment variables, a tactic that proved fruitful.">



    <meta property="og:url" content="http://localhost:1313/writeups/writeup11.txt/">
  <meta property="og:site_name" content="Mouhib CHVMSI">
  <meta property="og:title" content="K8SLANPARTY - CHALLENGES">
  <meta property="og:description" content="
CHALLENGE 1; Challenge Description: DNSing with the Stars You’ve gained shell access to a compromised Kubernetes pod and your next objective is to further compromise internal services. As a warm-up, utilize DNS scanning to uncover hidden internal services and obtain the flag. We’ve provided dnscan to facilitate this process for upcoming challenges.
All flags in this challenge follow the format: wiz_k8s_lan_party{*}
Solution; Given the task at hand, my initial approach was to inspect the environment variables, a tactic that proved fruitful.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2023-08-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-08-21T00:00:00+00:00">
    <meta property="article:tag" content="Kubernetes">
    <meta property="article:tag" content="CTF">
    <meta property="og:image" content="http://localhost:1313/">
      <meta property="og:see_also" content="http://localhost:1313/posts/2023/11/boost-your-apps-security-with-this-open-source-tool./">
      <meta property="og:see_also" content="http://localhost:1313/posts/2023/09/certifications-exam-notes/">
      <meta property="og:see_also" content="http://localhost:1313/writeups/writeup10.txt/">
      <meta property="og:see_also" content="http://localhost:1313/writeups/writeup09.txt/">
      <meta property="og:see_also" content="http://localhost:1313/writeups/writeup07.txt/">
      <meta property="og:see_also" content="http://localhost:1313/writeups/writeup01.txt/">






    <meta property="article:published_time" content="2023-08-21 00:00:00 &#43;0000 UTC" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark"> </span>
            <span class="logo__text">C:\Users\chxmxii\</span>
            <span class="logo__text" style="color:#ff3c36">writeup11.txt</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#ff3c36;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about.txt/" style="text-decoration: none;" class="name">About</a></li><li><a href="http://localhost:1313/posts/" style="text-decoration: none;" class="name">Posts</a></li><li><a href="http://localhost:1313/projects/" style="text-decoration: none;" class="name">Projects</a></li><li><a href="http://localhost:1313/writeups/" style="text-decoration: none;" class="name">Writeups</a></li><li><a href="http://localhost:1313/error.html" style="text-decoration: none;" class="name">~Resume</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/writeup11.txt/">K8SLANPARTY - CHALLENGES</a></h2>

            
            
            

            <div class="post-content">
                <p><img src="http://localhost:1313/files/k8slan.png#center" alt=""></p>
<hr>
<h1 id="challenge-1">CHALLENGE 1;</h1>
<h2 id="challenge-description-dnsing-with-the-stars">Challenge Description: DNSing with the Stars</h2>
<ul>
<li>
<p>You&rsquo;ve gained shell access to a compromised Kubernetes pod and your next objective is to further compromise internal services. As a warm-up, utilize DNS scanning to uncover hidden internal services and obtain the flag. We&rsquo;ve provided <code>dnscan</code> to facilitate this process for upcoming challenges.</p>
</li>
<li>
<p>All flags in this challenge follow the format: <code>wiz_k8s_lan_party{*}</code></p>
</li>
</ul>
<h3 id="solution">Solution;</h3>
<ul>
<li>
<p>Given the task at hand, my initial approach was to inspect the environment variables, a tactic that proved fruitful.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ printenv | grep kubernetes -i
</span></span><span style="display:flex;"><span>KUBERNETES_SERVICE_PORT_HTTPS<span style="color:#f92672">=</span><span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>KUBERNETES_SERVICE_PORT<span style="color:#f92672">=</span><span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>KUBERNETES_PORT_443_TCP<span style="color:#f92672">=</span>tcp://10.100.0.1:443
</span></span><span style="display:flex;"><span>KUBERNETES_PORT_443_TCP_PROTO<span style="color:#f92672">=</span>tcp
</span></span><span style="display:flex;"><span>KUBERNETES_PORT_443_TCP_ADDR<span style="color:#f92672">=</span>10.100.0.1
</span></span><span style="display:flex;"><span>KUBERNETES_SERVICE_HOST<span style="color:#f92672">=</span>10.100.0.1
</span></span><span style="display:flex;"><span>KUBERNETES_PORT<span style="color:#f92672">=</span>tcp://10.100.0.1:443
</span></span><span style="display:flex;"><span>KUBERNETES_PORT_443_TCP_PORT<span style="color:#f92672">=</span><span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ dnscan -subnet 10.100.0.1/16 &gt; file
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ cat file
</span></span><span style="display:flex;"><span>10.100.136.254 getflag-service.k8s-lan-party.svc.cluster.local.
</span></span><span style="display:flex;"><span>10.100.136.254 -&gt; getflag-service.k8s-lan-party.svc.cluster.local
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ curl 10.100.136.254
</span></span><span style="display:flex;"><span>wiz_k8s_lan_party<span style="color:#f92672">{</span>between-thousands-of-ips-you-found-your-northern-star<span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<hr>
<h1 id="challenge-2">CHALLENGE 2;</h1>
<h2 id="challenge-description-hello">Challenge Description: HELLO?</h2>
<ul>
<li>Sometimes, it feels like we&rsquo;re alone, but we must stay vigilant against hidden sidecars leaking sensitive information.</li>
</ul>
<h3 id="solution-1">Solution</h3>
<ul>
<li>
<p>As mentioned earlier, we were alerted about the possibility of sidecar containers. My first action was to rerun the <code>dnscan</code> command, leading me to discover the <code>reporting-service.k8s-lan-party.svc.cluster.local</code> service. This container seemed to be communicating with <code>istio-envoy</code>, a component of a service mesh. I then tried to listen to the traffic between the containers using <code>tcpdump -A</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ curl -kv reporting-service.k8s-lan-party.svc.cluster.local
</span></span><span style="display:flex;"><span>*   Trying 10.100.171.123:80...
</span></span><span style="display:flex;"><span>* Connected to reporting-service.k8s-lan-party.svc.cluster.local <span style="color:#f92672">(</span>10.100.171.123<span style="color:#f92672">)</span> port <span style="color:#ae81ff">80</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
</span></span><span style="display:flex;"><span>&gt; GET / HTTP/1.1
</span></span><span style="display:flex;"><span>&gt; Host: reporting-service.k8s-lan-party.svc.cluster.local
</span></span><span style="display:flex;"><span>&gt; User-Agent: curl/7.81.0
</span></span><span style="display:flex;"><span>&gt; Accept: */*
</span></span><span style="display:flex;"><span>&gt; 
</span></span><span style="display:flex;"><span>* Mark bundle as not supporting multiuse
</span></span><span style="display:flex;"><span>&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>&lt; server: istio-envoy
</span></span><span style="display:flex;"><span>&lt; date: Tue, <span style="color:#ae81ff">26</span> Mar <span style="color:#ae81ff">2024</span> 10:28:01 GMT
</span></span><span style="display:flex;"><span>&lt; content-type: text/plain
</span></span><span style="display:flex;"><span>&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>&lt; x-envoy-decorator-operation: :0/*
</span></span><span style="display:flex;"><span>&lt; transfer-encoding: chunked
</span></span><span style="display:flex;"><span>&lt; 
</span></span><span style="display:flex;"><span>* Connection <span style="color:#75715e">#0 to host reporting-service.k8s-lan-party.svc.cluster.local left intact</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ tcpdump -A | grep wiz
</span></span><span style="display:flex;"><span>tcpdump: verbose output suppressed, use -v<span style="color:#f92672">[</span>v<span style="color:#f92672">]</span>... <span style="color:#66d9ef">for</span> full protocol decode
</span></span><span style="display:flex;"><span>listening on ns-892853, link-type EN10MB <span style="color:#f92672">(</span>Ethernet<span style="color:#f92672">)</span>, snapshot length <span style="color:#ae81ff">262144</span> bytes
</span></span><span style="display:flex;"><span>wiz_k8s_lan_party<span style="color:#f92672">{</span>good-crime-comes-with-a-partner-in-a-sidecar<span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<hr>
<h1 id="challenge-3">CHALLENGE 3;</h1>
<h2 id="challenge-description-exposed-file-share">Challenge Description: Exposed File Share</h2>
<ul>
<li>The targeted big corp utilizes outdated, yet cloud-supported technology for data storage in production. But oh my, this technology was introduced in an era when access control was only network-based 🤦‍️.</li>
</ul>
<h3 id="solution-2">Solution;</h3>
<p>&ldquo;access control was only network-based&rdquo; is a big hint that we are talking about nfs here. lets check the df -hT command to see mounts in our system</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>player@wiz-k8s-lan-party:~$ df -hT
</span></span><span style="display:flex;"><span>Filesystem                                         Type     Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>overlay                                            overlay  300G   23G  278G   8% /
</span></span><span style="display:flex;"><span>fs-0779524599b7d5e7e.efs.us-west-1.amazonaws.com:/ nfs4     8.0E     <span style="color:#ae81ff">0</span>  8.0E   0% /efs
</span></span><span style="display:flex;"><span>tmpfs                                              tmpfs     60G   12K   60G   1% /var/run/secrets/kubernetes.io/serviceaccount
</span></span><span style="display:flex;"><span>tmpfs                                              tmpfs     64M     <span style="color:#ae81ff">0</span>   64M   0% /dev/null
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>dfdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>we can we have a fs system from this endpoint mounted on /efs, though i found the flag, but the challenge doesn<span style="color:#e6db74">&#39;t end here as we don&#39;</span>t have the permission to read that file
</span></span></code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/kubernetes/">Kubernetes</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/ctf/">CTF</a></span>
        
    </p>

            
  		</div>
    
<div id="particles-js" style="position: fixed; inset: 0; z-index: -1;"></div>
<script src="http://localhost:1313/js/particles.min.js"></script>
<script>
  particlesJS('particles-js',
    {
      "particles": {
        "number": {
          "value": 25,
          "density": {
            "enable": true,
            "value_area": 800
          }
        },
        "color": {
          "value": "#424569"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#ff3f38"
          },
          "polygon": {
            "nb_sides": 5
          },
          "image": {
            "src": "img/github.svg",
            "width": 100,
            "height": 100
          }
        },
        "opacity": {
          "value": 0.2305594644660164,
          "random": false,
          "anim": {
            "enable": false,
            "speed": 1,
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 3,
          "random": true,
          "anim": {
            "enable": false,
            "speed": 40,
            "size_min": 0.1,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": "#ff3f38",
          "opacity": 0.19875815902242794,
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 6,
          "direction": "none",
          "random": false,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": false,
            "mode": "repulse"
          },
          "onclick": {
            "enable": false,
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 400,
            "line_linked": {
              "opacity": 1
            }
          },
          "bubble": {
            "distance": 400,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 4
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    }
  );
</script>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            
            
            
            <span>© All right reserved chxmxii - 2022</span>
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="http://localhost:1313/bundle.min.63e1cd4087b02bc78961fcab2aaf77e957e2227557c73ab774f1cc4a9db0645e90d2403ca03e55eb0887e432e82aea10afe7f125052af6dd46cfea148ecbc663.js" integrity="sha512-Y&#43;HNQIewK8eJYfyrKq936VfiInVXxzq3dPHMSp2wZF6Q0kA8oD5V6wiH5DLoKuoQr&#43;fxJQUq9t1Gz&#43;oUjsvGYw=="></script>




    </body>
</html>
